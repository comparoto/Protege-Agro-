<div class="cadastro-container">
    <div class="cadastro-header">
        <h1>Cadastro</h1>
    </div>

    <form class="cadastro-form" [formGroup]="cadastroForm" (ngSubmit)="onSubmit()">
    
        <div class="form-group">
            <label>Insira seu nome</label>
            <input type="text" placeholder="Seu nome" formControlName="nome"
                   [ngClass]="{ 'is-invalid': f['nome'].invalid && f['nome'].touched }">
            
            @if (f['nome'].invalid && f['nome'].touched) {
                <div class="invalid-feedback">
                    @if (f['nome'].errors?.['required']) {
                        <div>Nome é obrigatório.</div>
                    }
                    @if (f['nome'].errors?.['minlength']) {
                        <div>Nome deve ter no mínimo 3 caracteres.</div>
                    }
                </div>
            }
        </div>

        <div class="form-group">
            <label>Insira seu email</label>
            <input type="email" placeholder="seu@email.com" formControlName="email"
                   [ngClass]="{ 'is-invalid': f['email'].invalid && f['email'].touched }">

            @if (f['email'].invalid && f['email'].touched) {
                <div class="invalid-feedback">
                    @if (f['email'].errors?.['required']) {
                        <div>Email é obrigatório.</div>
                    }
                    @if (f['email'].errors?.['email']) {
                        <div>Formato de email inválido.</div>
                    }
                </div>
            }
        </div>

        <div class="form-group">
            <label>Informe o telefone</label>
            <input type="tel" placeholder="(00) 00000-0000" formControlName="telefone"
                   [ngClass]="{ 'is-invalid': f['telefone'].invalid && f['telefone'].touched }">

            @if (f['telefone'].invalid && f['telefone'].touched) {
                <div class="invalid-feedback">
                    @if (f['telefone'].errors?.['required']) {
                        <div>Telefone é obrigatório.</div>
                    }
                    @if (f['telefone'].errors?.['telefoneInvalido']) {
                        <div>Telefone inválido (deve ter 10 ou 11 dígitos).</div>
                    }
                </div>
            }
        </div>

        <div class="form-group">
            <label>Insira sua senha</label>
            <div class="input-toggle-wrapper">
                <input 
                    [type]="visibilidadeSenhas.senha ? 'text' : 'password'" 
                    placeholder="Sua senha" 
                    formControlName="senha"
                    [ngClass]="{ 'is-invalid': f['senha'].invalid && f['senha'].touched }">
                
                <button type="button" (click)="toggleVisibilidade('senha')" class="toggle-senha-btn">
                    {{ visibilidadeSenhas.senha ? 'Esconder' : 'Mostrar' }}
                </button>
            </div>

            @if (f['senha'].invalid && f['senha'].touched) {
                <div class="invalid-feedback">
                    @if (f['senha'].errors?.['required']) {
                        <div>Senha é obrigatória.</div>
                    }
                    @if (f['senha'].errors?.['pattern']) {
                        <div>A senha deve ter 6+ caracteres, 1 número e 1 caractere especial.</div>
                    }
                </div>
            }
        </div>

        <div class="form-group">
            <label>Confirme sua senha</label>
            <div class="input-toggle-wrapper">
                <input 
                    [type]="visibilidadeSenhas.confirmarSenha ? 'text' : 'password'" 
                    placeholder="Confirme sua senha" 
                    formControlName="confirmarSenha"
                    [ngClass]="{ 'is-invalid': (f['confirmarSenha'].invalid && f['confirmarSenha'].touched) || (cadastroForm.errors?.['senhasNaoCoincidem'] && f['confirmarSenha'].touched) }">
                
                <button type="button" (click)="toggleVisibilidade('confirmarSenha')" class="toggle-senha-btn">
                    {{ visibilidadeSenhas.confirmarSenha ? 'Esconder' : 'Mostrar' }}
                </button>
            </div>

            @if (f['confirmarSenha'].invalid && f['confirmarSenha'].touched) {
                <div class="invalid-feedback">
                    @if (f['confirmarSenha'].errors?.['required']) {
                        <div>Confirmação de senha é obrigatória.</div>
                    }
                </div>
            }

            @if (cadastroForm.errors?.['senhasNaoCoincidem'] && f['confirmarSenha'].touched) {
                <div class="invalid-feedback">
                    As senhas não coincidem.
                </div>
            }
        </div>

        <div class="form-divider"></div>

        <div class="select-group">
            <div class="form-group">
                <label>Estado</label>
                <select formControlName="estado" [ngClass]="{ 'is-invalid': f['estado'].invalid && f['estado'].touched }">
                    <option value="">Selecione</option>
                    <option>Acre</option>
                    <option>Alagoas</option>
                    <option>Amapá</option>
                    <option>Amazonas</option>
                    <option>Bahia</option>
                    <option>Ceará</option>
                    <option>Espírito Santo</option>
                    <option>Goiás</option>
                    <option>Maranhão</option>
                    <option>Mato Grosso</option>
                    <option>Mato Grosso do Sul</option>
                    <option>Minas Gerais</option>
                    <option>Pará</option>
                    <option>Paraíba</option>
                    <option>Paraná</option>
                    <option>Pernambuco</option>
                    <option>Piauí</option>
                    <option>Rio de Janeiro</option>
                    <option>Rio Grande do Norte</option>
                    <option>Rio Grande do Sul</option>
                    <option>Rondônia</option>
                    <option>Roraima</option>
                    <option>Santa Catarina</option>
                    <option>São Paulo</option>
                    <option>Sergipe</option>
                    <option>Tocantins</option>
                </select>

                @if (f['estado'].invalid && f['estado'].touched) {
                    <div class="invalid-feedback">
                        @if (f['estado'].errors?.['required']) {
                            <div>Estado é obrigatório.</div>
                        }
                    </div>
                }
            </div>

            <div class="form-group">
                <label>RD</label>
                <select formControlName="regiao" [ngClass]="{ 'is-invalid': f['regiao'].invalid && f['regiao'].touched }">
                    <option value="">Selecione</option>
                    <option>Região 1</option>
                    <option>Região 2</option>
                    <option>Região 3</option>
                </select>

                @if (f['regiao'].invalid && f['regiao'].touched) {
                    <div class="invalid-feedback">
                        @if (f['regiao'].errors?.['required']) {
                            <div>Região é obrigatória.</div>
                        }
                    </div>
                }
            </div>
        </div>

        <div class="form-group">
            <label>Cultivo</label>
            <select formControlName="cultivo" [ngClass]="{ 'is-invalid': f['cultivo'].invalid && f['cultivo'].touched }">
                <option value="">Selecione</option>
                <option>Soja</option>
                <option>Milho</option>
                <option>Café</option>
                <option>Algodão</option>
            </select>

            @if (f['cultivo'].invalid && f['cultivo'].touched) {
                <div class="invalid-feedback">
                    @if (f['cultivo'].errors?.['required']) {
                        <div>Cultivo é obrigatório.</div>
                    }
                </div>
            }
        </div>

        <button type="submit" class="button-registrar" [disabled]="cadastroForm.invalid">
            Registrar
        </button>
        <div class="login-link">
            Já tem uma conta? <a routerLink="/login">Faça login</a>
        </div>
    </form>
</div>